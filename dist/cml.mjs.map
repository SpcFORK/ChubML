{"version":3,"sources":["../src/cml.ts"],"sourcesContent":["// @ CowSTD\nimport { chaosGl, chaosEval, NOOP, ANOOP } from './cst';\nimport { CowErr } from './CowErr';\n\nimport '../global'\n\n// @ CML\nimport { CML_Static } from './static';\nimport { CustomEventHandle } from './CustomEventHandle';\nimport { CILEList, ChubNode, SortedCILE } from './CILEList';\nimport { checkEnvironment } from './checkEnvironment';\n\n/**\n * A ChubML instance.\n * \n * =-=-=-=--=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=--=-=-=-=-\n *\n * 2024\n * SpcFORK - ChubML\n * Copyright (c) SpcFORK\n * \n * =-=-=-=--=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=--=-=-=-=-\n *\n * ```go\n *       ,\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\",^,\"\"\"\"\"\"\"\"\"\"\"\",\n *     .l ?]]]]]]]]]]]]]]]].~.????????????.I\n *     \",!l]IIIIIIIIIIIIIIII,< ]]]]]]]]]]]] l\n *     l ]]]lllllllllllllIII:> ]]]]]]]]]]]] l\n *     l:iii>>>>>>>>>>>>>]]] ~ ]]]]]]]]]]]] l\n *     l`++++++++++++++++---.~ ]]]]]]]]]]]] l\n *     lIIIIIIIIIIIIIIIIIIII;~.??????----?? l\n *     lIlllllllllllllllllll:iI\"\"\"\"\"\",;:;''l;\".\n *     l;lllllllllllllllllll:l    '^,,Iii??]-i;\".\n *     `I,I:::::::::I,,,,,,,:`   ,;ii??]]]]]]]-i\",\n *      ,:iiiiiiiii:,          :IIii!!!!!!!?]]]I:\"\n *      l ]]]]]]]]] l           ^`````````l.]]]] i\n *      l ]]]]]]]]] l                   .`l.]]]]?.I\n *      l.?]]]]]]]] l         ,\"\"\"\"\"\"\"\"\";!!?]]]]] l\n *      `i ]]]]]]]] l        I.?????????-]]]]]]]I\";\n *       ;:I]]]]]]]l;\"\"\"\"\"\"\",! ]]]]]]]]]]]]]]]?!^;\n *        I,i-]]]]]]-???????.~ ]]]]]]]]]]]]]?!,,^\n *         ^IIi?-]]]]]]]]]]] ~ ]]]]]]]]]]??!,,^\n *           ^I\"I!!!!!!!!!!!\">:!!!!!!!!!!,\",^\n *              ^```````````^ ^``````````^\n * ```\n * \n * =-=-=-=--=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=--=-=-=-=-\n * \n * TODO:\n * - Make code cleaner/compact.\n * - Make ECSS.\n * - Create CHUBECSS Parser.\n * \n * =-=-=-=--=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=--=-=-=-=-\n * \n * TOUR:\n *   *Q-Sel:\n *   $()\n *   *Array matcher\n *       arrMatch\n *   *Parser:\n *     parse()\n *       -> sortInd()\n *       -> stringi()\n *\n * =-=-=-=--=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=--=-=-=-=-\n*/\nexport class ChubMLMod extends CML_Static {\n  static ChubML = ChubMLMod\n  ChubML = ChubMLMod\n\n  static #ChubStarted = new CustomEventHandle('chubstart');\n  static #ChubInjected = new CustomEventHandle('chubinjected');\n\n  // @ Options\n  static {\n    chaosGl.lastChub ||= \"\"\n    chaosGl.cbMode ||= \"\"\n    chaosGl.chubLocation ||= \"\"\n\n    window.onload = () => {\n      this.#ChubStarted.detail = this\n      this.#ChubStarted.activate();\n    }\n  }\n\n  #makeDef = (_?: SortedCILE): ChubNode => ({\n    tag: \"\",\n    id: \"\",\n    class: \"\",\n    content: \"\",\n    data: \"\",\n    style: \"\",\n    attr: \"\",\n    indent: 0,\n    [Symbol.unscopables]: {\n      _: _ || null\n    }\n  })\n\n  #_(scope: Record<string, any> & { [Symbol.unscopables]: any }) {\n    return Reflect.get(scope, Symbol.unscopables)\n  }\n\n  #makeIndexes = () => ({\n    str: 0,\n    tmp: 0,\n  })\n\n  #specialTags = [\n    'area',\n    'base',\n    'br',\n    'col',\n    'embed',\n    'hr',\n    'img',\n    'input',\n    'link',\n    'meta',\n    'param',\n    'source',\n    'track',\n    'wbr'\n  ]\n\n  get doc() {\n    return document\n  }\n\n  #setOrAppend(val: string | Element, p: Element) {\n    if (typeof val === 'string') this.body.innerHTML = val\n    else this.body.appendChild(val)\n  }\n\n  get body() {\n    return document.body\n  }\n  set body(val) {\n    this.#setOrAppend(val, this.body)\n  }\n\n  get head() {\n    return document.head\n  }\n  set head(val) {\n    this.#setOrAppend(val, this.head)\n  }\n\n  get html() {\n    return document.documentElement\n  }\n  get title() {\n    return document.title\n  }\n  set title(val) {\n    document.title = val\n  }\n\n  get chubLocation(): string {\n    return chaosGl.chubLocation\n  }\n  set chubLocation(val) {\n    chaosGl.chubLocation = val\n  }\n\n  get chubDev(): boolean {\n    return chaosGl.chubDev\n  }\n  set chubDev(val) {\n    chaosGl.chubDev = val\n  }\n\n  #orStr(str: string, def = '') {\n    return str ? str : def\n  }\n\n  #prepSpcIf(str: string) {\n    return str ? str + ' ' : ''\n  }\n\n  s = CML_Static\n\n  styled = {} as Record<string, any>\n\n  #Rexps = () => this.s.Rexps\n  #initialFormat(str: string) {\n    let r = this.#Rexps\n    return str\n      .replace(r().lineWithComment, \"\")\n      .replace(r().formatspace2, \"\\n\")\n      .replace(r().formatspace1, \"\\n\")\n  }\n\n  #cascadeIndentList(str: string) {\n    let strLines = str.split(/;/);\n\n    let col = [] as CILEList\n\n    for (const line of strLines) col.push({\n      c: line.trim(),\n      i: line.search(/\\S/)\n    });\n\n    return col;\n  }\n\n  #sortCILIndent(contents: CILEList) {\n    const sortedContents = [];\n    let parentStack = [];\n\n    for (const content of contents) {\n      const currentIndent = content.i;\n      const currentContent = { c: content.c, i: currentIndent, children: [] };\n\n      while (parentStack.length > 0 && currentIndent <= parentStack[parentStack.length - 1].i)\n        parentStack.pop();\n\n      if (parentStack.length > 0) {\n        const parent = parentStack[parentStack.length - 1];\n        parent.children.push(currentContent);\n      } else {\n        sortedContents.push(currentContent);\n      }\n\n      parentStack.push(Object.assign(currentContent));\n    };\n\n    return sortedContents\n  }\n\n  #handleScript(scrmatch: string[] | null) {\n    const r = this.#Rexps;\n\n    let src = scrmatch![1]\n    let issrc = src.includes(\"src=\");\n    let execafter = src.includes(\"\\\"execafter\\\";\\n\");\n\n    var dostill = true;\n\n    const fetchScript = async (src: string) => {\n      let pt = await fetch(src)\n      let t = await pt.text()\n\n      // Append a script tag to the body\n      try {\n        let script = document.createElement(\"script\");\n        script.type = \"text/javascript\";\n        script.text = t;\n        document.body.appendChild(script);\n      }\n      catch (error) { console.log(error, this.s.errorList.scripterror); }\n    };\n\n    // Source Check\n    if (issrc && scrmatch) {\n      let srcis = src.match(/src=\"(.*)\"/);\n      if (srcis) {\n        fetchScript(srcis[1]);\n        dostill = false;\n      }\n    }\n\n    // Eval content (not SRC).\n    if (scrmatch !== null && dostill) {\n      try { chaosEval(src) }\n      catch (error) { console.error(error, this.s.errorList.scripterror) }\n    }\n  }\n\n  async #handleAtFetch(tempC: ChubNode, param: string) {\n    // param = param.slice(8); // @fetchw=\n\n    if (window?.location?.origin) {\n      param = `${param}`.includes(\"{{ORIG}}\")\n        ? param.replace(\"{{ORIG}}\", window.location.origin)\n        : param;\n    }\n\n    tempC.tag = tempC.tag\n      ? tempC.tag\n      : 'fetcherBlock';\n\n    tempC.data = (\n      `${this.#prepSpcIf(tempC.data)}data-fetchw=\"${param}\"`\n      + ` data-instance=\"${new Date().getTime()}\"`\n    );\n\n    let fw = await fetch(await this.findFile([param])) || {\n      text: () => { return param; },\n    };\n\n    let fwtext = await fw.text();\n    tempC.content = `${fwtext ? fwtext : \"\"}`;\n\n    // If window is loaded before script end, replace content.\n    if (window?.location?.origin) {\n      let el = this.$(`[${tempC.data.split(' ').join('][')}]`);\n      if (el)\n        el.innerHTML = tempC.content.replace(/\\n/g, '\\n</br>\\n');\n    }\n    return param;\n  }\n\n  #handleAtEval(tempC: ChubNode, ev: string) {\n    try { var scriptRes = new Function(ev).bind(tempC)(this) }\n    catch (error) { return console.error(error, this.s.errorList.scripterror) }\n    if (this.chubDev) console.log(\"AtEval: \", scriptRes);\n    if (scriptRes) this.#handleAtPutCont(tempC, scriptRes);\n  }\n\n  #handleAtPutCont(tempC: ChubNode, param: string) {\n    let r = this.#orStr(param)\n    tempC.content += r\n    if (this.chubDev) console.log(\"AtPutCont: \", param);\n  }\n\n  #handleAtCall(tempC: ChubNode, globalRef: string) {\n    let r = this.#orStr(globalRef)\n    let res = chaosEval(r)\n\n    if (!res) throw new CowErr(\"CowErr\", \"No Call: \" + r)\n    if (typeof res !== 'function') throw new CowErr(\"CowErr\", \"Not a function: \" + r)\n\n    let cr = res(tempC)\n    if (cr) this.#handleAtPutCont(tempC, cr)\n    if (this.chubDev) console.log(\"Call: \", cr);\n  }\n\n  #handleAtFrom(tempC: ChubNode, param: string) {\n    let r = this.#orStr(param)\n    let template = this.$(r)\n    if (!template) throw new CowErr(\"CowErr\", \"No Template: \" + r)\n    let res = template.innerHTML\n    tempC.content += res\n    if (this.chubDev) console.log(\"AtFrom: \", res)\n  }\n\n  // #watchVar(tempC: ChubNode, param: string) {\n  //   let v: unknown;\n  // }\n\n  /** @@ - At Codes */\n  #handleAtCode(tempC: ChubNode, param: any) {\n    if (typeof param !== \"string\") return;\n    /*\n      We need to:\n\n      Extract the @val from the param.\n      If as params, get params.\n\n      E.G.\n      tag @fetchw=https://www.google.com\n    */\n    if (this.chubDev)\n      console.log(\"using @: \", `${param}`.slice(1).split(/[=>]/));\n\n    const S_name = param.slice(1)\n    function prune(len: number): string {\n      return S_name.slice(len + 1);\n    }\n    function starts(str: string): boolean {\n      return S_name.startsWith(str);\n    }\n\n    switch (true) {\n      case starts('fetchw'):\n        this.#handleAtFetch(tempC, prune(6));\n        break;\n\n      case starts('eval'):\n        this.#handleAtEval(tempC, prune(4));\n        break;\n\n      case starts(':'):\n        this.#handleAtPutCont(tempC, prune(0));\n        break;\n\n      case starts('call'):\n        this.#handleAtCall(tempC, prune(4));\n        break;\n\n      case starts('from'):\n        this.#handleAtFrom(tempC, prune(4));\n        break;\n\n      case starts(''):\n\n      default: console.log(\"no valid @ found...?\", param);\n    }\n\n    return param;\n  }\n\n  #appendAttr(tempC: ChubNode, nodeName: keyof ChubNode, newAttr: string, expectedPrefixLen = 1) {\n    let pv = (newAttr as string).slice(expectedPrefixLen);\n    (tempC[nodeName] as any) = this.#prepSpcIf(tempC[nodeName].toString()) + pv;\n  }\n\n  #handleClass(tempC: ChubNode, param: any) {\n    this.#appendAttr(tempC, 'class', param);\n  }\n\n  #handleID(tempC: ChubNode, param: any) {\n    this.#appendAttr(tempC, 'id', param);\n  }\n\n  #handleData(tempC: ChubNode, param: any) {\n    this.#addAttribute(tempC, param, 'data', true);\n  }\n\n  #handlePercAttr(tempC: ChubNode, param: any) {\n    this.#addAttribute(tempC, param, 'attr', false);\n  }\n\n  #addAttribute(tempC: ChubNode, param: any, type: 'data' | 'attr', isData: boolean) {\n    let attrParam = this.attrSyn(param);\n    if (!attrParam) return;\n\n    let name = attrParam[0].slice(1)\n    let value = attrParam[1];\n\n    let attrB = `${name}=\"${value}\"`;\n    if (isData) attrB = `data-${attrB}`\n\n    tempC[type] = this.#prepSpcIf(tempC[type]) + attrB;\n  }\n\n  #handleChubAttr(param: any, tempC: ChubNode, paramI: number) {\n    switch (param[0]) {\n      case \"#\":\n        this.#handleID(tempC, param);\n        break;\n\n      case \".\":\n        this.#handleClass(tempC, param);\n        break;\n\n      case \"$\":\n        this.#handleData(tempC, param);\n        break;\n\n      case \"%\":\n        this.#handlePercAttr(tempC, param);\n        break;\n\n      case \"@\":\n        param = this.#handleAtCode(tempC, param);\n        break;\n\n      default: tempC.tag = this.#prepSpcIf(tempC.tag) + param;\n    }\n    return param;\n  }\n\n  #checkAttr = (tempC: ChubNode, arr: any[]) => arr.forEach((param, paramI) => {\n    param = this.#handleChubAttr(param, tempC, paramI);\n  })\n\n  #traverse(cil: SortedCILE, i: number, indexes: { str: any; tmp: number; }, v = ''): [SortedCILE, { str: number, tmp: number }] {\n    const r = this.#Rexps\n\n    let indentString = \"  \"\n\n    let str = cil.c\n    let isStr = str.search(r().betweenQuote)\n    let hasOpts = str.search(r().betweenCol)\n    let isscr = str.match(r().script)\n\n    let def = this.#makeDef(cil)\n    let tempC = this.#makeDef(cil)\n\n    // Script Operation\n    if (isscr !== null) {\n      this.#handleScript(r().script.exec(str));\n    }\n\n    // Text Operation\n    if (isStr !== -1) {\n      let tempLines = str.split(r().betweenCol)\n      let content = str.split(r().betweenQuote)[1]\n\n      if (hasOpts == null) {\n        tempC = def\n      } else {\n        var inner = tempLines[1] || \"\"\n        this.#checkAttr(tempC, inner.split(\" \"))\n      }\n\n      indexes.str++\n      tempC.content = content\n    } else {\n      this.#checkAttr(tempC, str.split(\" \"))\n    }\n\n    cil.o = tempC\n    cil.i = indentString.repeat(i)\n\n    if (cil.children) {\n      cil.children.forEach(child => this.#traverse(child, i + 1, indexes, v));\n    }\n\n    return [cil, indexes]\n  }\n\n  // @ Templates\n  #parseTemplates(cil: SortedCILE, opts = this.#makeIndexes()) {\n    const { o } = cil\n\n    let isTemplate = false\n\n    if (!o) throw new CowErr(`No CIL object found!`)\n    switch (o.tag) {\n\n    }\n\n    return { isTemplate }\n  }\n\n  #handleSHead(html: string, lessNl: any): string {\n    for (let stydm in this.styled) if (this.styled[stydm] === true && this.styled.styles[stydm]) {\n      let p = lessNl ? '' : '\\n'\n      html = html.replace(\"<head>\", \"<head>\" + p + this.styled.styles[stydm]);\n\n      // Set to \"has\" since we check earlier if the value is false to define it\n      // Also, might use later, need to exist, not be true.\n      this.styled[stydm] = \"has\";\n    }\n    return html;\n  }\n\n  #handleSpecialTag(html: string, lessNl: any): string {\n    if (html.includes(\"head\")) {\n      html = this.#handleSHead(html, lessNl);\n    }\n    return html;\n  }\n\n  #handleCNAttr(html: string, o: ChubNode) {\n    const is = (v: any) => !!v;\n    const addTo = (v: any) => html += v;\n\n    if (is(o.class))\n      addTo(` class=\"${o.class}\"`);\n\n    if (is(o.id))\n      addTo(` id=\"${o.id}\"`);\n\n    if (is(o.style))\n      addTo(` style=\"${o.style}\"`);\n\n    if (is(o.data))\n      addTo(` ${o.data}`);\n\n    if (is(o.attr))\n      addTo(` ${o.attr}`);\n    return html;\n  }\n\n  #buildHeadTag(html: string, cil: SortedCILE, o: ChubNode, isSpecial: number, shorter: boolean, lessNl: boolean) {\n    let p = lessNl ? \"\" : \"\\n\"\n    html = p + `${lessNl ? '' : cil.i}<${o.tag}`;\n\n    html = this.#handleCNAttr(html, o);\n\n    if (isSpecial > 0)\n      shorter = true;\n\n    let end = \">\" + p\n\n    if (shorter) html += \" /\"\n    html += end\n\n    return { html, shorter };\n  }\n\n  #handleBuildChild(child: SortedCILE, html: string, opts: { str: number; tmp: number; }, lessNl: boolean | undefined) {\n    let p = lessNl ? \"\" : child.i\n    switch (child.c[0]) {\n      case \"\\\"\":\n        html += p + child.c.slice(1, child.c.length - 1);\n        break;\n\n      default:\n        html += p + this.#parseChubNode(child, opts, lessNl);\n    }\n    return html;\n  }\n\n  #buildChildren(cil: SortedCILE, html: string, opts: { str: number; tmp: number; }, lessNl: boolean | undefined) {\n    for (const child of cil.children)\n      html = this.#handleBuildChild(child, html, opts, lessNl);\n    return html;\n  }\n\n  #buildFootTag(html: string, shorter: boolean, cil: SortedCILE, o: ChubNode, lessNl: boolean) {\n    let p = lessNl ? \"\" : \"\\n\"\n\n    html += p\n    if (!shorter) html += `${lessNl ? '' : cil.i}</${o.tag}>${p}`\n\n    // ¯\\_(ツ)_/¯ Quickest fix.\n    if (html.includes('<>')) html = html\n      .replace(\"<>\", \"\")\n      .replace(\"</>\", \"\")\n\n    return html;\n  }\n\n  #buildContent(cil: SortedCILE, html: string, lessNl: boolean) {\n    let p = lessNl ? \"\" : cil.i + '  '\n    if (cil.o?.content)\n      html += p + cil.o.content;\n    return html;\n  }\n\n  #parseChubNode(cil: SortedCILE, opts = this.#makeIndexes(), lessNl = false) {\n    const o = cil.o!\n    if (!o) throw new CowErr(`No CIL object found!`)\n\n    let shorter = false\n\n    let specialfind = this.arrMatch(o.tag, this.#specialTags)\n    let isSpecial = specialfind.count\n    let inList = specialfind.list\n\n    let html = ''\n\n    let { isTemplate } = this.#parseTemplates(cil, opts);\n\n    // This is enough for certain tags.\n    ({ html, shorter } = this.#buildHeadTag(html, cil, o, isSpecial, shorter, lessNl));\n\n    html = this.#buildContent(cil, html, lessNl);\n\n    html = this.#buildChildren(cil, html, opts, lessNl);\n\n    html = this.#buildFootTag(html, shorter, cil, o, lessNl);\n\n    html = this.#handleSpecialTag(html, lessNl);\n\n    return html\n  }\n\n  #constuctFrom(cil: SortedCILE, lessNl: boolean | undefined, v = '') {\n    let indexes = this.#makeIndexes()\n\n    let travRes = this.#traverse(cil, 0, indexes, v);\n\n    // @Crossover\n    { [cil, indexes] = travRes }\n\n    let res = this.#parseChubNode(cil, indexes, lessNl)\n\n    return res\n  }\n\n  parse(source: string, lessNl?: boolean | undefined) {\n    let str = this.#initialFormat(source)\n\n    let indList = this.#cascadeIndentList(str)\n\n    let sorted = this.#sortCILIndent(indList);\n\n    return this.#constuctFrom(sorted[0], lessNl);\n  }\n\n  async findFile(fileLocations: any) {\n    for (const location of fileLocations) {\n      try { var res = await fetch(location) }\n      catch (error) {\n        console.error(`Error fetching file from '${location}':`, error);\n      }\n      if (res!?.ok)\n        return location;\n    }\n\n    // Return null if no valid file location was found\n    return null;\n  }\n\n  ChubRep(doc: string, quirky = \"<!DOCTYPE html>\") {\n    (doc as any) = this.parse(doc, true);\n    document.open();\n    document.write(quirky + '\\n' + doc);\n    document.close();\n  }\n\n  injectChub(input: string) {\n    // var input = `\n    // div;\n    //   \"wow, im super simple. <br>\n    //   and supper COOOL!\";\n    //   hr #wow $hey=lol .very .omg .neat %omg=js|is|cool;\n    //   :Super .cool: \"WOOO!\";\n    //     span .woah;\n    //       \"wow!\";\n    // `;\n\n    var htmlCode = this.parse(input, true);\n\n    if (this.chubDev == true) console.log(htmlCode)\n\n    let locationB = this.chubLocation || \"chub\"\n    let locationGot = this.$(locationB)\n    if (!locationGot) locationB = \"body\"\n    else locationGot.innerHTML = htmlCode;\n\n    // On finish, run finish.\n    // chaosGl.chubinjected?.(locationGot);\n    ChubMLMod.#ChubInjected.detail = locationGot;\n    ChubMLMod.#ChubInjected.activate();\n  }\n\n  Router = class Router {\n    __env__ = checkEnvironment();\n\n    constructor() {\n      switch (this.__env__) {\n        case \"Node\":\n          break;\n        case \"Browser\":\n          break;\n      }\n    }\n\n  }\n\n  // Reformat Attributes to prevent conflicts and such.\n  CHUBfax(tex: string, sep = \" \") {\n    let modtxt = tex || \"\";\n    modtxt = modtxt\n      .replaceAll(\"=\", \"|e\")\n      .replaceAll(\";\", \"|col\")\n      .replaceAll(\"\\\"\", \"|qw\")\n      .replaceAll(sep, \"|\")\n\n    return modtxt\n  }\n\n  attrSyn(tex: string) {\n    if (`${tex}`.match(/=/gm)!?.length > 1) throw this.s.errorList.eqspl3\n\n    let attrParam = tex\n      // Tokenize\n      .replace(\"=\", \" spcfork.Equals.Token \")\n      .replace(\"\\\\|\", \" spcfork.Pipe.Token \")\n\n      .replace(/\\|e/gm, \"=\")\n      .replace(/\\|col/gm, \";\")\n      .replace(/\\|qw/gm, \"\\\"\")\n      .replace(/\\|/gm, \" \")\n\n      .replace(\" spcfork.Pipe.Token \", \"|\")\n\n      // Split at Token to prevent multiple splits.\n      .split(\" spcfork.Equals.Token \")\n\n    // console.log(attrParam.length, attrParam)\n    return attrParam\n  }\n\n  /**\n   * Fetch a web page and convert it to CHUB\n   * @param {string} url The URL of the web page to fetch\n   * @returns The CHUB representation of the web page\n   */\n  async CHUBWFetch(url: string | URL | Request): Promise<string> {\n    const response = await fetch(url);\n    if (!response?.ok)\n      throw new Error(`HTTP error! Status: ${response.status}`);\n    const html = await response.text();\n    return this.HTMLToChub(html);\n  }\n\n  getURLbit() {\n    var url = window.location.href;\n    var parts = url.split('/');\n    var lastPart = parts[parts.length - 1];\n\n    return lastPart;\n  }\n\n  CHUBsanitize(input: string) {\n    var element = document.createElement('div');\n    element.innerText = input;\n    var sanitizedInput = element.innerHTML;\n    return sanitizedInput;\n  }\n\n  DupeCollection = {} as Record<string, any>\n  /**\n   * @param {string} dupe - The dupe to be added to the collection.\n   * @returns {object} - The edited dupe, the dupe collection, and the stringified and parsed collection.\n   */\n  CHUBduper(dupe: string = \"p;\"): object {\n    if (!this.DupeCollection) {\n      this.DupeCollection = {};\n    }\n\n    if (this.DupeCollection[dupe] !== undefined) {\n      this.DupeCollection[dupe] += 1;\n    } else {\n      this.DupeCollection[dupe] = 0;\n    }\n\n    let editedDupe;\n    if (dupe.includes(\";\")) {\n      let d = dupe.split(\";\");\n      d[0] += ` #${this.DupeCollection[dupe]}`;\n      editedDupe = d.join(\"\");\n    } else {\n      editedDupe = dupe + \";\";\n    }\n\n    let d = {\n      editedDupe,\n      D: this.DupeCollection,\n      s: (() => JSON.stringify(this.DupeCollection)),\n      c: (() => JSON.parse(d.s())),\n    };\n\n    return d\n  }\n\n  CHUBstrprep(str: string) {\n    return str\n      .replace(/[.*+?^${}()|[\\]\\\\\"';:]/g, '\\\\$&')\n      .replace(/[;]/g, '|col')\n  }\n\n  CHUBunmess(str: string) {\n    const escapedStr = str.replace(/\\\\\\\"/g, '\"');\n    const unescapedStr = escapedStr.replace(/\\\\\\|col/g, ',');\n\n    return [\n      unescapedStr,\n      JSON.parse(unescapedStr),\n    ]\n  }\n\n  MLTextToNodes(str: string, type: DOMParserSupportedType = 'text/html') {\n    return new DOMParser().parseFromString(str, type);\n  }\n\n  Chubify(str: string) {\n    let parsedHTML = this.parse(str, true)\n    let parsedDOM = this.MLTextToNodes(parsedHTML, 'text/html')\n    return parsedDOM\n  }\n\n  // ARARARAR\n  HTMLToChub = (html: string | Element, delim = \"\") => {\n    if (html instanceof Element) html = html.outerHTML;\n\n    const doc = this.MLTextToNodes(html, 'text/html');\n    return this.getChubML(doc.documentElement, '', delim)\n  }\n\n  getChubML = (node: Element, indent = '', delim = '') => {\n    let chubML = '';\n\n    // Process node name\n    chubML += `${indent}${node.nodeName.toLowerCase()}`;\n\n    // Process attributes\n    if (node.attributes.length > 0) {\n      const attrs = Array.from(node.attributes);\n      chubML = this.#handleAttr(attrs, chubML);\n    }\n\n    // Process child nodes\n    if (node.childNodes.length > 0)\n      chubML = this.#handleChildren(chubML, node, indent, delim);\n    else\n      chubML += ';\\n';\n\n    return chubML;\n  }\n\n  #handleChildTextNode(child: Element, indent: string) {\n    if (!child.textContent) return '';\n    let t = child.textContent.trim();\n    if (t != \"\") return `${indent}  \"${t}\";\\n`;\n    return '';\n  }\n\n  #handleChildren(chubML: string, node: Element, indent: string, delim: string) {\n    chubML += ';\\n';\n    const childNodes = Array.from(node.childNodes);\n    for (const child of childNodes) switch (child.nodeType) {\n      case Node.TEXT_NODE:\n        chubML += this.#handleChildTextNode(child as Element, indent);\n        break;\n      case Node.ELEMENT_NODE:\n        chubML += this.getChubML(child as Element, indent + '  ', delim);\n        break;\n    }\n    chubML += `${indent}${delim}\\n`;\n    return chubML;\n  }\n\n  #handleAttr(attrs: Attr[], chubML: string) {\n    const cfv = (attr: Attr) => this.CHUBfax(attr.value)\n    for (const attr of attrs) switch (attr.name.toLowerCase()) {\n      case 'class':\n        chubML += ` .${cfv(attr)}`;\n        break;\n      case 'id':\n        chubML += ` #${cfv(attr)}`;\n\n      default: chubML += ` %${attr.name}=${cfv(attr)}`;\n    }\n    return chubML;\n  }\n\n  aliasIndexes = [\n    \"beam.lmc\",\n    \"beam.chub\",\n\n    \"index.lmc\",\n    \"index.chub\",\n  ]\n\n  async #checkFile(loc: string | URL | Request, opts = {}) {\n    let req = await fetch(loc, { method: \"HEAD\", ...opts })\n    return [req.ok, req] as [boolean, Response]\n  }\n\n  async #getFileSafely(loc: string | URL | Request) {\n    let [ok, okRes] = await this.#checkFile(loc)\n    if (!ok) throw new Error(`File not found!`)\n    let req = await fetch(loc)\n    return { req, okRes }\n  }\n\n  async #findFileOfCases(fileLocations: string[]) {\n    for (const loc of fileLocations) {\n      let [ok, okRes] = await this.#checkFile(loc)\n      if (ok) return loc\n    }\n    return null\n  }\n\n  #batchFile = (\n    handleFile: Function,\n    loc: string\n  ): Promise<[string, boolean]> => new Promise(async (resolve, reject) => {\n    try {\n      await handleFile(loc, resolve);\n    } catch (error) {\n      reject(error);\n    }\n  });\n\n  async #batchFileOfCases(fileLocations: string[]) {\n    let pArr = [] as Promise<[string, boolean]>[];\n    let abortController = new AbortController();\n\n    const handleFile = async (loc: string, resolve: Function) => {\n      if (abortController.signal.aborted) throw new Error(\"Aborted\");\n      let [f] = await this.#checkFile(loc, { signal: abortController.signal });\n      if (f) abortController.abort();\n      resolve([loc, f]);\n    }\n\n    for (const loc of fileLocations)\n      pArr.push(this.#batchFile(handleFile, loc));\n\n    let resses = await Promise.all(\n      pArr.map(p => p.catch(e => ['', false] as ['', boolean]))\n    );\n\n    // Find first valid res\n    for (const [res, ok] of resses)\n      if (ok) return res;\n\n    return null;\n  }\n\n  async #fileOrFallback(loc: string | URL | Request, slowly = false) {\n    let [ok, okRes] = await this.#checkFile(loc)\n    if (ok) return loc\n    return slowly\n      ? await this.#findFileOfCases(this.aliasIndexes)\n      : await this.#batchFileOfCases(this.aliasIndexes)\n  }\n\n  async beamPrep(location: string | URL | Request, slowly: boolean) {\n    let fileName = await this.#fileOrFallback(location, slowly);\n    if (!fileName)\n      throw new Error(`File not found!`);\n    let req = await this.#getFileSafely(fileName);\n    chaosGl.lastChub = req;\n    return { ...req, location };\n  }\n\n  async beamParse(req: Response, location: any = '') {\n    let text = await req.text();\n    let doc = this.parse(text, true);\n    return { text, doc, location }\n  }\n\n  async beamMake(location: string | URL | Request, slowly: boolean) {\n    let { req } = await this.beamPrep(location, slowly);\n    return await this.beamParse(req, location);\n  }\n\n  async beamDo(req: Response, DOM: any) {\n    let { text, doc, location } = await this.beamParse(req);\n    this.beamRender(doc, DOM, { location, text });\n  }\n\n  beamRender(doc: string, DOM: any, optionalDetails = {}) {\n    if (this.chubDev) console.log(doc);\n\n    let entrypoint = DOM || this.chubLocation || 'chub';\n    let locationGot = this.$(entrypoint) || document.body\n\n    locationGot.innerHTML = doc;\n\n    // On finish, run finish.\n    // chaosGl.chubinjected?.(locationGot);\n    ChubMLMod.#ChubInjected.detail = {\n      nodes: locationGot,\n      text: doc,\n      ...optionalDetails\n    };\n    ChubMLMod.#ChubInjected.activate();\n  }\n\n  async beamSync(location: string | URL | Request, DOM: any, slowly = false) {\n    // Creates a factory which does prep, then returns a function which does the actual work.\n    let { req } = await this.beamPrep(location, slowly);\n    return async () => await this.beamDo(req, DOM);\n  }\n\n  /**\n   * Example usage:\n   * \n   * ```typescript\n   * const cml = new ChubMLMod();\n   * cml.beamChub('/path/to/chub/file', document.getElementById('app'), true);\n   * ```\n   * \n   * @param slowly - If true, errors are ignored and execution using a quicker Promise.all, this is better for users, worse for servers.\n   */\n  async beamChub(location: string | URL | Request, DOM: any, slowly = false) {\n    return await (await this.beamSync(location, DOM, slowly))();\n  }\n\n  constructor() {\n    super()\n\n    try { this.#elevateToWindow() } catch { }\n  }\n\n  #elevateToWindow() {\n\n  }\n}\n\nconst chubml = new ChubMLMod;\n\n// @ Exporter\ntry { module.exports = chubml } catch { }\ntry { chaosGl.window.ChubML = chubml } catch { }"],"mappings":"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","names":["ChubMLMod","_ChubMLMod","CML_Static","#ChubStarted","CustomEventHandle","#ChubInjected","chaosGl","#makeDef","_","#_","scope","#makeIndexes","#specialTags","#setOrAppend","val","p","#orStr","str","def","#prepSpcIf","#Rexps","#initialFormat","r","#cascadeIndentList","strLines","col","line","#sortCILIndent","contents","sortedContents","parentStack","content","currentIndent","currentContent","#handleScript","scrmatch","src","issrc","execafter","dostill","fetchScript","t","script","error","srcis","chaosEval","#handleAtFetch","tempC","param","fwtext","el","#handleAtEval","ev","scriptRes","#handleAtPutCont","#handleAtCall","globalRef","res","CowErr","cr","#handleAtFrom","template","#handleAtCode","S_name","prune","len","starts","#appendAttr","nodeName","newAttr","expectedPrefixLen","pv","#handleClass","#handleID","#handleData","#addAttribute","#handlePercAttr","type","isData","attrParam","name","value","attrB","#handleChubAttr","paramI","#checkAttr","arr","#traverse","cil","i","indexes","v","indentString","isStr","hasOpts","isscr","tempLines","inner","child","#parseTemplates","opts","o","isTemplate","#handleSHead","html","lessNl","stydm","#handleSpecialTag","#handleCNAttr","is","addTo","#buildHeadTag","isSpecial","shorter","end","#handleBuildChild","#parseChubNode","#buildChildren","#buildFootTag","#buildContent","specialfind","inList","#constuctFrom","source","indList","sorted","fileLocations","location","doc","quirky","input","htmlCode","locationB","locationGot","checkEnvironment","tex","sep","modtxt","url","response","parts","lastPart","element","sanitizedInput","dupe","editedDupe","d","unescapedStr","parsedHTML","delim","node","indent","chubML","attrs","#handleAttr","#handleChildren","#handleChildTextNode","childNodes","cfv","attr","#checkFile","loc","req","#getFileSafely","ok","okRes","#findFileOfCases","#batchFile","handleFile","resolve","reject","#batchFileOfCases","pArr","abortController","f","resses","e","#fileOrFallback","slowly","fileName","text","DOM","optionalDetails","entrypoint","#elevateToWindow","chubml"]}